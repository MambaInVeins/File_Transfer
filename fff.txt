yangzi62

1、Blog单向数据通道

访问目标网站，利用隐蔽通道，定位信息点，放置或获取数据，加密数据（算法为AES256，固定密钥为BotID）。

Getchannelinfo(type, param)

type标识数据通道类型，param是定位通道所需的参数，目前仅支持三种type：

CHN_REDDIT
CHN_PASSBIN
CHN_SMS1

返回：
|邮箱A|密码|IMAP服务器|端口|控制邮箱B|回连时间|回连间隔|

一、获取邮箱通道信息

通过模拟HTTPS请求，https://www.reddit.com/search/?q=keyword，keyword是预设的关键词，找到第一个开头为[a~n]的新闻，按留言的时间排序https://www.reddit.com/r/FreeSpeech/comments/hwk0sb/after_massive_surge_in_crime_trump_approves/?sort=new，找到第一个用户名里面包含Bot后四位用户的留言，其中最后一个单词的超链接地址，去掉https://和.onion，再删除其中的点，用BotID作为解密密钥，算法为AES-256（带salt）

数据格式

|邮箱A|密码|IMAP服务器|端口|控制邮箱B|回连时间|回连间隔|

回连时间是linux时间戳，回连间隔是分钟，回连时间到达之前不回连，达到之后依据回连间隔周期回连。

例如：
|xxx@hotmailcom|1qaz@WSX|imap.hotmail.com|143|yyy@gmail.com|1596782511|300|



获取配置模块设计细则v1.0

获取配置模块是一条单向传输的通道。设计原则为安全、隐蔽、反溯源、抗分析。设置配置尽量也能提供自动化的方法实现，设置配置可以有界面交互
方式一：reddit下发配置
1.1 搜索确定帖子

通过模拟HTTPS请求，https://www.reddit.com/search/?q=keyword，keyword是预设的关键词，找到第一个开头为[a~n]的新闻。
注：关键词keyword是内置在Bot里面的
1.2 枚举定位评论

依据1.1的方法，找到帖子后，按评论的时间排序，依据时间顺序枚举，找到用户名里面包含Bot后四位用户的留言内容。
例如：https://www.reddit.com/r/FreeSpeech/comments/hwk0sb/after_massive_surge_in_crime_trump_approves/?sort=new
1.3 提取隐蔽数据

依据1.2的方法，找到相应的留言后，留言中包含一个超连接，提取超链接地址，去掉https://和.onion，再删除其中的点，得到一个加密后的string，此时用BotID作为解密密钥，算法为AES-256（带salt），解密出的数据即为配置数据。
1.4 数据格式

|邮箱A|密码|IMAP服务器|端口|控制邮箱B|回连时间|回连间隔|

回连时间是linux时间戳，回连间隔是分钟，回连时间到达之前不回连，达到之后依据回连间隔周期回连。

例如：
|xxx@hotmailcom|1qaz@WSX|imap.hotmail.com|143|yyy@gmail.com|1596782511|300|
方式二：pastebin下发配置
2.1 搜索用户

通过模拟HTTPS请求，访问pasterbin用户页面，例如https://pastebin.com/u/xxxxxx，如果用户不存在，则不回连，继续潜伏。
注：用户名xxxxxx是内置在Bot里面的
2.2 提取隐蔽数据

通过2.1搜索，如果存在该用户，则提取最近一个title里面包含Bot后四位的分享，下载内容，用BotID作为解密密钥，算法为AES-256（带salt），解密出的数据即为配置数据。
2.3 数据格式

同上
方式三：SMS下发配置
3.1 确定手机号

每天访问https://receive-sms.com/，确定第一个免费的demo手机号。
3.2 提取隐蔽数据

轮询3.1确定的手机号所收到的短信，如果短信内容以G-xxxxxx开头，xxxxxx是6为的数字，前三位是后三位的平方模1000，那么后面的内容就是隐蔽数据，用BotID作为解密密钥，算法为AES-256（带salt），解密出的数据即为配置数据。
3.3 数据格式

同上